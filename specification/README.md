# 仕様書

## 概要
「HighLowChess」はプレイヤー2人で行う対戦形式のボードゲームである。  
プレイヤーはそれぞれ盤面上の駒を動かし、勝利条件を満たすことを目指す。  

## 用語
### プレイヤー
プレイヤーは実際の人間である。  
プレイヤーの持つアカウントにはID、ニックネーム、パスワード、勝敗数の情報が紐づけられている。  
ID、ニックネームはユニークなものであり、IDはゲームが自動的に生成する。
対戦では、2人のプレイヤーのどちらかのチームカラーが赤色に、もう一方は青色となり、陣地や駒のふちがその色になる。  

### ロビー
ロビーはログインしたプレイヤーが試合を開始するための場所である。
プレイヤーはここで、ランダムマッチ参加、ルーム作成、ルーム一覧確認、ルーム参加、チャット、自身を含むプレイヤーの一覧と勝敗数の確認が行える。  

### ルーム
ルームは特定のプレイヤー間で対戦を行うための場所である。  
ルームはプレイヤーが作成することができる。  
ルームは固有のIDを持ち、作成時に自動的に割り振られる。  
ルームには3人以上入ることができる。  
ルーム内にいるプレイヤーはルーム内向けのチャット、ルーム内対戦、ルームへの招待、キックができる。  
既存のルームにはルーム一覧から入ることができる。  
ルームは中にいるプレイヤーが0人になったときに削除される。  

### 盤面
盤面はプレイヤーが駒を置くゲームのステージである。  
プレイヤーは対戦時に、盤面を挟んで向かい合う。  
盤面は正方形のマスの集合で構成されており、プレイヤーから見て横6マス、縦5マスである。  
各プレイヤーから見て、最も近い行は自分の陣地と呼び、そのプレイヤーの色で塗られている。  

### 駒
駒はプレイヤーが対戦中に操作するものである。  
駒には表裏があり、表面はすべて同じ模様である。  
裏面には1～9のいずれかの数字または王冠が記述されている。  
また、駒のそれぞれの面には上下左右斜めの8方向のいずれか複数に、小さな三角形が表示されている。  
どちらのプレイヤーの駒か分かりやすいよう、淵は赤または青で塗られている。  
駒はゲーム開始時に全て表向きに置くが、1度戦闘を行った駒は裏向きに置く。  

## シーン・機能一覧  
- タイトルシーン
    - サインアップ機能
    - ログイン機能
- ロビーシーン
    - ルーム作成機能
    - マッチング機能
        - ランダムマッチ
        - ルームマッチ
    - チャット機能
    - ステータス表示機能
- 対戦シーン
    - 対戦機能

## サインアップ機能
アカウントを持たないプレイヤーが、アカウントを作成する機能である。  
タイトルシーンの「サインアップ」ボタンを押すことでダイアログが表示される。  
アカウント作成にはニックネーム、パスワードを入力する必要がある。  
ニックネームが未使用の場合はアカウントが作成され、ロビーシーンに移動する。  
ニックネームが使用済みの場合はメッセージが表示され、やり直しになる。  
ダイアログには「ログイン」ダイアログへの切り替えボタンがある。  

## ログイン機能
アカウントを持つプレイヤーがログインする機能である。  
タイトルシーンの「ログイン」ボタンを押すことでダイアログが表示される。  
ログインにはニックネームとパスワードが必要である。  
入力されたニックネーム、パスワードがあっている場合はロビーシーンに移動する。  
どちらかが違う場合、メッセージが表示されやり直しになる。  
ダイアログには「ログイン」ダイアログへの切り替えボタンがある。  

## ルーム作成機能
ルーム作成機能はルームに入っていないプレイヤーが、ルームを作成する機能である。  
ロビーで「ルーム作成」ボタンを押すことで作成できる。  

## マッチング機能
マッチング機能は、ログインしているプレイヤーが対戦を行うための機能である。  
ロビーの「マッチング」ボタンを押すことでマッチング待ちになることができる。  
ルームに入っている場合はルーム内の他プレイヤーがマッチング待ち時、入っていない場合は他の入っていないプレイヤーがマッチング待ち時に、そのプレイヤーと対戦を行う。  
マッチング成立後は対戦シーンに移行する。  

## チャット機能
チャット機能はロビーにいるほかのプレイヤーとテキストでコミュニケーションを取る機能である。  
チャットはロビー全員向けと、ルーム内向けの2種類があり、切り替えることができる。  
ルームに入っていない場合はロビー全員向けのみになる。  

## ステータス表示機能


## 対戦機能

### 対戦の流れ
対戦の流れは以下の通りである。  
1. それぞれのプレイヤーが持っている10個の駒のうち、キングを除いた9個からランダムに2個除外する。
2. 自分のキングの駒と残った7個の駒の内4個を、盤面の最も自分寄りの行に自由に配置する。
3. ランダムに先行後攻を決める。
4. 各プレイヤーは自分のターンに、自分の駒のいずれか1つを1回移動する。
5. 移動先に相手の駒がある場合、戦闘を行う。
6. 移動または戦闘終了後相手のターンになる。
7. どちらかのプレイヤーが勝利条件を満たした場合に、対戦を終了しロビーに戻る。

### 駒の移動
各プレイヤーは自分のターンに自分の駒を1つ移動させることができる。  
移動可能な方向は、駒の表示されている面の、三角形が表示されている方向である。  
移動距離は1回の移動につき1マスである。  
移動先に自分の駒が居る場合は移動できず、相手の駒が居る場合は戦闘が発生する。  

### 戦闘
駒の移動先に相手の駒が居る場合、戦闘が発生する。  
移動させた側は、HighかLowを宣誓する。  
その後2つの駒の裏面を表示する。  
Highを選んだ場合数字の高い駒が、Lowを選んだ場合は数字の低い駒が勝利し、敗北した駒はゲームから除外される。  
2つの駒の数字が同じ場合、引き分けとなり方とも盤面に残る。  
戦闘終了後、戦闘した駒は裏向きに盤面に残り、数字が公開されたままになる。  
キングが戦闘を行った場合、もう一方が数字の駒の場合宣誓によらずキング側が敗北する。
キング同士の戦闘では、キングを移動させた側が勝利する。

### 勝利条件
次の2つのいずれかを満たしたプレイヤーは対戦に勝利する。  
* 自分のキングが相手の陣地に到達する。
* 相手のキングに対して戦闘を行う。

